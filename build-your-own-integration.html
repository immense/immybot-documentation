<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>immy.bot | immy.bot</title>
    <meta name="description" content="A documentation suite for all things ImmyBot">
    <link rel="preload stylesheet" href="/assets/style.8969d4a5.css" as="style">
    
    <script type="module" src="/assets/app.40223181.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.392dd896.js">
    <link rel="modulepreload" href="/assets/chunks/theme.e2eedf84.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-c0b17d02.1d06aec7.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-d6f8fe3a.16492242.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-58f49b84.d7117976.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-dedf2781.e765dbc7.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-e0ffc2d1.360b2500.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-088dbd90.102a66cc.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-64895a6e.b0edf630.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-3fca7ce7.33c2ed10.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-0ca4be02.1a5cdbee.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-e13af0f0.bb760a07.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-84aa38e3.05e7c819.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-a8cc8886.c4e9fd4f.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-802a48d3.c551589a.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-9a586ac6.a8f33278.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-96f2b9df.bda11d56.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-adaa34f8.5a20f2de.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-56584a6c.245ccd90.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-1a90b03d.42edacec.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-57868176.243ab20f.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-a7f8e230.f971402b.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.ade1a5ba.js">
    <link rel="modulepreload" href="/assets/build-your-own-integration.md.b4fea51b.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4064354f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-4064354f data-v-5bdc5df3><div class="VPNavBar has-sidebar" data-v-5bdc5df3 data-v-f1abbc6e><div class="container" data-v-f1abbc6e><div class="title" data-v-f1abbc6e><div class="VPNavBarTitle has-sidebar" data-v-f1abbc6e data-v-2973dbb4><a class="title" href="/" data-v-2973dbb4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/immybot-glasses.png" alt data-v-ab19afbb><!--]--><!--[-->immy.bot<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-f1abbc6e><div class="curtain" data-v-f1abbc6e></div><div class="content-body" data-v-f1abbc6e><!--[--><!--]--><div class="VPNavBarSearch search" data-v-f1abbc6e><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-f1abbc6e data-v-5e9f0637><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-5e9f0637 data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-f1abbc6e data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-f1abbc6e data-v-c8c2ae4b data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aa8de344><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aa8de344><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-c8c2ae4b><div class="item appearance" data-v-c8c2ae4b><p class="label" data-v-c8c2ae4b>Appearance</p><div class="appearance-action" data-v-c8c2ae4b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-c8c2ae4b data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-c8c2ae4b><div class="item social-links" data-v-c8c2ae4b><div class="VPSocialLinks social-links-list" data-v-c8c2ae4b data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-f1abbc6e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-4064354f data-v-9e669cc1><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-9e669cc1><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-9e669cc1><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-9e669cc1>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9e669cc1 data-v-24251f6f><button data-v-24251f6f>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-4064354f data-v-ee2efba5><div class="curtain" data-v-ee2efba5></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ee2efba5><span class="visually-hidden" id="sidebar-aria-label" data-v-ee2efba5> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/getting-started.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Getting Started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/releases.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>What's New</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./add-users.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Add Users</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./onboarding.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Onboarding</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./recommended-deployments.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Recommended Deployments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./terminology.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Terminology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./troubleshooting.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Troubleshooting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./user-roles.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>User Roles</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./windows-sandbox.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Windows Sandbox</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible has-active" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Integrations</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/build-your-own-integration.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Build Your Own</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-automate-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Automate</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-control-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Control</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-manage-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Manage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/ncentral-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>N-Central</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/halo-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>HaloPSA</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/azure-graph-permissions-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Azure</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Advanced</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/scripts.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Scripting Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/immy-commands.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Metascripts / Cloud Scripts</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0" data-v-ee2efba5 data-v-bd01e0d5><!----><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/FAQ.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Frequently Asked Questions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-4064354f data-v-3cf691b6><div class="VPDoc has-sidebar has-aside" data-v-3cf691b6 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><div class="aside" data-v-a3c25e27><div class="aside-curtain" data-v-a3c25e27></div><div class="aside-container" data-v-a3c25e27><div class="aside-content" data-v-a3c25e27><div class="VPDocAside" data-v-a3c25e27 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-cb998dce data-v-3a6c4994><div class="content" data-v-3a6c4994><div class="outline-marker" data-v-3a6c4994></div><div class="outline-title" role="heading" aria-level="2" data-v-3a6c4994>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-3a6c4994><span class="visually-hidden" id="doc-outline-aria-label" data-v-3a6c4994> Table of Contents for current page </span><ul class="root" data-v-3a6c4994 data-v-463da30f><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _build-your-own-integration" data-v-a3c25e27><div><h2 id="build-your-own-integrations" tabindex="-1">Build Your Own Integrations <a class="header-anchor" href="#build-your-own-integrations" aria-label="Permalink to &quot;Build Your Own Integrations&quot;">​</a></h2><p>The goal of this feature is primarily for our own use to more rapidly implement integrations with other RMMs and PSA, but we have opened it up for you to create your own integrations as well.</p><h3 id="concepts" tabindex="-1">Concepts <a class="header-anchor" href="#concepts" aria-label="Permalink to &quot;Concepts&quot;">​</a></h3><p>Behind the scenes, an integration is any class that inherits from the <code>IProvider</code> interface.</p><p>We have created a new <code>Integration</code> script type with <code>New-DynamicIntegration</code> and <code>Add-DynamicIntegrationCapability</code> Cmdlets that allow you to construct your own <code>IProvider</code> and give it capabilities, all within PowerShell.</p><p>Integrations capabilities are defined in interfaces typically prefixed with <code>ISupports...</code></p><p>Let&#39;s say you want your integration to have a Client mapping UI in ImmyBot. You would implement <code>ISupportsListingClients</code> which has a <code>GetClients</code> method.</p><p>When loading your integration, the ImmyBot engine will recognize that <code>integration is ISupportsListingClients</code> and will show the Clients tab on the Integration page.</p><p><img src="https://github.com/immense/immybot-documentation/assets/31077619/67ea8b15-0ae9-44e6-b3e0-9de250b15010" alt="image"></p><h4 id="dynamic-integration-capabilities" tabindex="-1">Dynamic Integration Capabilities <a class="header-anchor" href="#dynamic-integration-capabilities" aria-label="Permalink to &quot;Dynamic Integration Capabilities&quot;">​</a></h4><ul><li>List Customers from the remote system so they can be mapped in the ImmyBot UI</li><li>List Computers/Agents (Think RMM Agent, AV agent etc) from a remote system</li><li>Provide an inventory script that returns the agent id (that gets mapped to the id from the API)</li><li>Provide Tenant level install tokens automatically scoped based on the Customer mapping above</li><li>Disable/Enable Maintenance Mode/Learning Mode in remote systems during maintenance</li><li>Respond to HttpRequests in PowerShell (like an Azure PowerShell function) but utilizing the Metascript engine</li></ul><hr><h3 id="basic-implementation" tabindex="-1"><strong>Basic Implementation</strong> <a class="header-anchor" href="#basic-implementation" aria-label="Permalink to &quot;**Basic Implementation**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">OpResult</span><span style="color:#E1E4E8;">]::Ok()</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">OpResult</span><span style="color:#24292E;">]::Ok()</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><hr><h3 id="initialization-with-parameters" tabindex="-1"><strong>Initialization with Parameters</strong> <a class="header-anchor" href="#initialization-with-parameters" aria-label="Permalink to &quot;**Initialization with Parameters**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Password</span><span style="color:#E1E4E8;">(StripValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">OpResult</span><span style="color:#E1E4E8;">]::Ok()</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Password</span><span style="color:#24292E;">(StripValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">OpResult</span><span style="color:#24292E;">]::Ok()</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><img src="https://github.com/immense/immybot-documentation/assets/1424395/4f8ba329-f57f-4504-875d-c6ee3a53816c" alt="image"></p><hr><h3 id="initialization-with-parameters-integrationcontext" tabindex="-1"><strong>Initialization with Parameters &amp; <code>$IntegrationContext</code></strong> <a class="header-anchor" href="#initialization-with-parameters-integrationcontext" aria-label="Permalink to &quot;**Initialization with Parameters &amp; `$IntegrationContext`**&quot;">​</a></h3><p>Building on the previous example, the integration parameters are stored in the <code>$IntegrationContext</code>:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Password</span><span style="color:#E1E4E8;">(StripValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    $IntegrationContext.S1Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1Uri</span></span>
<span class="line"><span style="color:#E1E4E8;">    $IntegrationContext.S1ApiKey </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1ApiKey</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">OpResult</span><span style="color:#E1E4E8;">]::Ok()</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Password</span><span style="color:#24292E;">(StripValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    $IntegrationContext.S1Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1Uri</span></span>
<span class="line"><span style="color:#24292E;">    $IntegrationContext.S1ApiKey </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1ApiKey</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">OpResult</span><span style="color:#24292E;">]::Ok()</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><hr><h3 id="adding-isupportslistingclients" tabindex="-1"><strong>Adding <code>ISupportsListingClients</code></strong> <a class="header-anchor" href="#adding-isupportslistingclients" aria-label="Permalink to &quot;**Adding `ISupportsListingClients`**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Password</span><span style="color:#E1E4E8;">(StripValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingClients </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetClients {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#E1E4E8;">[]])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Implement logic to get clients directly in this script</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Client1&quot;</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Client2&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationClient</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientName </span><span style="color:#79B8FF;">$_</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Password</span><span style="color:#24292E;">(StripValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingClients </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetClients {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#24292E;">[]])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Implement logic to get clients directly in this script</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Client1&quot;</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Client2&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationClient</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientName </span><span style="color:#005CC5;">$_</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><hr><h3 id="adding-isupportslistingagents" tabindex="-1"><strong>Adding <code>ISupportsListingAgents</code></strong> <a class="header-anchor" href="#adding-isupportslistingagents" aria-label="Permalink to &quot;**Adding `ISupportsListingAgents`**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># ... *same as above* ...</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingClients </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetClients {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#E1E4E8;">[]])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Implement logic to get clients directly in this script</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Client1&quot;</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Client2&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationClient</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientName </span><span style="color:#79B8FF;">$_</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingAgents </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetAgents {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Immybot.Backend.Domain.Providers.IProviderAgentDetails</span><span style="color:#E1E4E8;">[]])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">[]]$ClientIds </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$null</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Implement logic to get agents directly in this script</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Agent1&quot;</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Agent2&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationAgent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">AgentId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Name </span><span style="color:#79B8FF;">$_</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># ... *same as above* ...</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingClients </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetClients {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#24292E;">[]])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Implement logic to get clients directly in this script</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Client1&quot;</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Client2&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationClient</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientName </span><span style="color:#005CC5;">$_</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingAgents </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetAgents {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Immybot.Backend.Domain.Providers.IProviderAgentDetails</span><span style="color:#24292E;">[]])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">[]]$ClientIds </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$null</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Implement logic to get agents directly in this script</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Mockup code for example purposes</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Agent1&quot;</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Agent2&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationAgent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">AgentId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Name </span><span style="color:#005CC5;">$_</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><hr><h3 id="move-duplicate-code-to-a-module" tabindex="-1"><strong>Move duplicate code to a Module</strong> <a class="header-anchor" href="#move-duplicate-code-to-a-module" aria-label="Permalink to &quot;**Move duplicate code to a Module**&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Password</span><span style="color:#E1E4E8;">(StripValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingClients </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetClients {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Import-Module</span><span style="color:#E1E4E8;"> SentinelOne</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Get-S1Site</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationClient</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Id </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientName </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingAgents </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetAgents {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Import-Module</span><span style="color:#E1E4E8;"> SentinelOne</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Get-S1Agent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationAgent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">AgentId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Id </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Name </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Password</span><span style="color:#24292E;">(StripValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingClients </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetClients {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Import-Module</span><span style="color:#24292E;"> SentinelOne</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Get-S1Site</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationClient</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Id </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientName </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Name</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingAgents </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetAgents {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Import-Module</span><span style="color:#24292E;"> SentinelOne</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Get-S1Agent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationAgent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">AgentId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Id </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Name </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Name</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><hr><h4 id="integration-context" tabindex="-1">Integration Context <a class="header-anchor" href="#integration-context" aria-label="Permalink to &quot;Integration Context&quot;">​</a></h4><p><code>$IntegrationContext</code> is a Hashtable used to share data between the ScriptBlocks <em>within the integration only</em>.</p><p>By design, the data in <code>$IntegrationContext</code> is where you put sensitive data like Access Tokens.</p><p>It is not available in scripts outside of the integration as this could expose those tokens via the Debugger.</p><p>Instead, we provide the following Cmdlets to access integration data from the Metascript context:</p><ul><li>Get-IntegrationAgentInstallToken</li><li>Get-IntegrationTenantUninstallTokenCmdlet</li><li>Get-IntegrationAgentUninstallTokenCmdlet</li></ul><p>These Cmdlets do not require any parameters as everything they need is available in the Action&#39;s context.</p><p>Let&#39;s say you create an integration that has an agent that requires an install token.</p><p>You would create a piece of Software and link it to that Integration Type, essentially saying &quot;This software is the agent for SentinelOne&quot;.</p><p>When you create a Deployment for that Software, if there are multiple integrations of that type, you will be required to select one. (Maybe you are migrating SentinelOne from one server to another)</p><p>That Deployment will create an Action on the session linked back to that Deployment, that is linked to that specific SentinelOne instance.</p><p>When you call Get-IntegrationAgentInstallToken from within the SentinelOne install script, the backend calls GetTenantInstallToken(string clientId) on the SentinelOne integration provided by the Deployment. ClientId is provided automatically by looking up the Computer&#39;s ImmyBot tenantId in the integration&#39;s Client mapping.</p><p><img src="https://github.com/immense/immybot-documentation/assets/31077619/ebdbfab0-a149-4d0d-8e56-cad8291df879" alt="image"></p><p><img src="https://github.com/immense/immybot-documentation/assets/31077619/f5a9d865-2a7d-4843-9a58-298557dd674d" alt="image"></p><h3 id="example-sentinelone" tabindex="-1">Example: SentinelOne <a class="header-anchor" href="#example-sentinelone" aria-label="Permalink to &quot;Example: SentinelOne&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># These parameters generate the form on the New/Edit Integration page</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># [DisplayName(&quot;API Key&quot;)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Password</span><span style="color:#E1E4E8;">(StripValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    $providerTypeFormData </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Write-Variable</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Note: The SentinelOne module is a Module script in Global </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Import-Module</span><span style="color:#E1E4E8;"> SentinelOne    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Get-Command</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Module SentinelOne </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Write-Host</span></span>
<span class="line"><span style="color:#E1E4E8;">    $S1AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Connect-S1API</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">S1Uri $S1Uri </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">S1APIToken $S1ApiKey</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># The SentinelOne module in Global will automatically use the following $IntegrationContext values if present</span></span>
<span class="line"><span style="color:#E1E4E8;">    $IntegrationContext.S1Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1Uri</span></span>
<span class="line"><span style="color:#E1E4E8;">    $IntegrationContext.S1ApiKey </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1ApiKey</span></span>
<span class="line"><span style="color:#E1E4E8;">    $IntegrationContext.AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">OpResult</span><span style="color:#E1E4E8;">]::Ok()</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">HealthCheckResult</span><span style="color:#E1E4E8;">])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># todo: implement health check</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-HealthyResult</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># ISupportsListingClients will create a Clients tab on the Integration for mapping ImmyBot tenants to the Clients returned by this script</span></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingClients </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetClients {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#E1E4E8;">[]])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># return a list of clients for this integration using the New-IntegrationClient cmdlet</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Import-Module</span><span style="color:#E1E4E8;"> SentinelOne</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Get-S1Site</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Verbose </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">New-IntegrationClient</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Id </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientName </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports listing agents</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsListingAgents </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetAgents {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Immybot.Backend.Domain.Providers.IProviderAgentDetails</span><span style="color:#E1E4E8;">[]])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">[]]$ClientIds </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$null</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># ClientIds will contain the clientids you mapped to ImmyBot tenants under the Integration-&gt;Clients tab</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># The agents you return here will go into the Computers-&gt;Pending Identification area until they are linked to Computers via the AgentId provided by ISupportsInventoryIdentification</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Import-Module</span><span style="color:#E1E4E8;"> SentinelOne</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">foreach</span><span style="color:#E1E4E8;">($ClientId </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> $ClientIds)</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Get-S1Agent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">SiteId $ClientId </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Verbose </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ForEach-Object</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">New-IntegrationAgent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">AgentId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.uuid </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Name </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.computerName </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">SerialNumber </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.serialNumber </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">OSName </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.osName </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Manufacturer </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.modelName </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ClientId </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.siteId </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">IsOnline </span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">AgentVersion </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.agentVersion </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">SupportsRunningScripts </span><span style="color:#79B8FF;">$false</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports inventory identification</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsInventoryIdentification </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetInventoryScript {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># This ScriptBlock will be run in the Metascript context for every machine during initial identification and daily inventory</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Invoke-ImmyCommand</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># Return the SentinelOne AgentId</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># We will match it to New-IntegrationAgent -AgentId you returned in ISupportsListingAgents</span></span>
<span class="line"><span style="color:#E1E4E8;">        $path </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Resolve-Path</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;C:\Program Files\SentinelOne\Sentinel Agent*\SentinelCtl.exe&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">($path)</span></span>
<span class="line"><span style="color:#E1E4E8;">        {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;"> $path.Path agent_id</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports retrieving a tenant install token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsTenantInstallToken </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetTenantInstallToken {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">System.String</span><span style="color:#E1E4E8;">])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$clientId</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Get-S1Site</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Id $clientId </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;">{ </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.registrationToken}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports retrieving a tenant uninstall token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsTenantUninstallToken </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">GetTenantUninstallToken {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">System.String</span><span style="color:#E1E4E8;">])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$true</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">System.String</span><span style="color:#E1E4E8;">]$clientId</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;implement me&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsHttpRequest </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HandleHttpRequest {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Microsoft.AspNetCore.Mvc.IActionResult</span><span style="color:#E1E4E8;">])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$True</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Microsoft.AspNetCore.Http.HttpContext</span><span style="color:#E1E4E8;">]$httpContext</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$false</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $body</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$True</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $route</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">will response to  </span><span style="color:#9ECBFF;">&quot;plugins/api/v1/{providerLinkId}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># handle a http request sent to this integration</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># return an [ObjectResult] and set the status code</span></span>
<span class="line"><span style="color:#E1E4E8;">    $res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">ObjectResult</span><span style="color:#E1E4E8;">]::new(</span><span style="color:#9ECBFF;">&#39;ok&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    $res.StatusCode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $res;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $Integration</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># These parameters generate the form on the New/Edit Integration page</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># [DisplayName(&quot;API Key&quot;)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Password</span><span style="color:#24292E;">(StripValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    $providerTypeFormData </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Write-Variable</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Note: The SentinelOne module is a Module script in Global </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Import-Module</span><span style="color:#24292E;"> SentinelOne    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Get-Command</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Module SentinelOne </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Write-Host</span></span>
<span class="line"><span style="color:#24292E;">    $S1AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Connect-S1API</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">S1Uri $S1Uri </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">S1APIToken $S1ApiKey</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># The SentinelOne module in Global will automatically use the following $IntegrationContext values if present</span></span>
<span class="line"><span style="color:#24292E;">    $IntegrationContext.S1Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1Uri</span></span>
<span class="line"><span style="color:#24292E;">    $IntegrationContext.S1ApiKey </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1ApiKey</span></span>
<span class="line"><span style="color:#24292E;">    $IntegrationContext.AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">OpResult</span><span style="color:#24292E;">]::Ok()</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">HealthCheckResult</span><span style="color:#24292E;">])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># todo: implement health check</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-HealthyResult</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># ISupportsListingClients will create a Clients tab on the Integration for mapping ImmyBot tenants to the Clients returned by this script</span></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingClients </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetClients {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Immybot.Backend.Domain.Providers.IProviderClientDetails</span><span style="color:#24292E;">[]])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># return a list of clients for this integration using the New-IntegrationClient cmdlet</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Import-Module</span><span style="color:#24292E;"> SentinelOne</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Get-S1Site</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Verbose </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">New-IntegrationClient</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Id </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientName </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Name</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports listing agents</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsListingAgents </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetAgents {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Immybot.Backend.Domain.Providers.IProviderAgentDetails</span><span style="color:#24292E;">[]])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">[]]$ClientIds </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$null</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># ClientIds will contain the clientids you mapped to ImmyBot tenants under the Integration-&gt;Clients tab</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># The agents you return here will go into the Computers-&gt;Pending Identification area until they are linked to Computers via the AgentId provided by ISupportsInventoryIdentification</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Import-Module</span><span style="color:#24292E;"> SentinelOne</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">foreach</span><span style="color:#24292E;">($ClientId </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> $ClientIds)</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Get-S1Agent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">SiteId $ClientId </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Verbose </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ForEach-Object</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">New-IntegrationAgent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">AgentId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.uuid </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Name </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.computerName </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">SerialNumber </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.serialNumber </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">OSName </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.osName </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Manufacturer </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.modelName </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ClientId </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.siteId </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">IsOnline </span><span style="color:#005CC5;">$true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">AgentVersion </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.agentVersion </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">SupportsRunningScripts </span><span style="color:#005CC5;">$false</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports inventory identification</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsInventoryIdentification </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetInventoryScript {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># This ScriptBlock will be run in the Metascript context for every machine during initial identification and daily inventory</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Invoke-ImmyCommand</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># Return the SentinelOne AgentId</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># We will match it to New-IntegrationAgent -AgentId you returned in ISupportsListingAgents</span></span>
<span class="line"><span style="color:#24292E;">        $path </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Resolve-Path</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;C:\Program Files\SentinelOne\Sentinel Agent*\SentinelCtl.exe&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">($path)</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">.</span><span style="color:#24292E;"> $path.Path agent_id</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports retrieving a tenant install token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsTenantInstallToken </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetTenantInstallToken {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">System.String</span><span style="color:#24292E;">])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$clientId</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Get-S1Site</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Id $clientId </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">%</span><span style="color:#24292E;">{ </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.registrationToken}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># supports retrieving a tenant uninstall token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsTenantUninstallToken </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">GetTenantUninstallToken {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">System.String</span><span style="color:#24292E;">])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$true</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">System.String</span><span style="color:#24292E;">]$clientId</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;implement me&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsHttpRequest </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HandleHttpRequest {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Microsoft.AspNetCore.Mvc.IActionResult</span><span style="color:#24292E;">])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$True</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Microsoft.AspNetCore.Http.HttpContext</span><span style="color:#24292E;">]$httpContext</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$false</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $body</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$True</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $route</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">will response to  </span><span style="color:#032F62;">&quot;plugins/api/v1/{providerLinkId}&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># handle a http request sent to this integration</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># return an [ObjectResult] and set the status code</span></span>
<span class="line"><span style="color:#24292E;">    $res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">ObjectResult</span><span style="color:#24292E;">]::new(</span><span style="color:#032F62;">&#39;ok&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    $res.StatusCode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">200</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $res;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $Integration</span></span></code></pre></div><h4 id="sentinelone-module" tabindex="-1">SentinelOne Module <a class="header-anchor" href="#sentinelone-module" aria-label="Permalink to &quot;SentinelOne Module&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Connect-S1API</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$S1Uri</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$S1APIToken</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $S1AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{ </span><span style="color:#9ECBFF;">&#39;Authorization&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;APIToken </span><span style="color:#E1E4E8;">$S1ApiToken</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># if we have an integration context, then store it</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">$null</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-ne</span><span style="color:#E1E4E8;"> $IntegrationContext) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $IntegrationContext.AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#E1E4E8;">    $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1Uri</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">Uri</span><span style="color:#E1E4E8;">]$</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $S1Uri</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $SystemInfo </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint </span><span style="color:#9ECBFF;">&#39;system/info&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($SystemInfo.latestAgentVersion </span><span style="color:#F97583;">-like</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;*.*&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Progress</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Authenticated to SentinelOne API and retrieved system/info. LatestAgentVersion: </span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$SystemInfo.LatestAgentVersion</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1AuthHeader</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$null</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Invalid response from system/info API&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Write-Verbose</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;SystemInfo:</span><span style="color:#79B8FF;">`r`n</span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$SystemInfo</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">Format-List</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">*</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$null</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">throw</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Endpoint</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Method</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Body</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">HashTable</span><span style="color:#E1E4E8;">]$QueryParameters </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{}</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $Endpoint </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Endpoint.TrimStart(</span><span style="color:#9ECBFF;">&#39;/&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    $params </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{}</span></span>
<span class="line"><span style="color:#E1E4E8;">    $params.ContentType </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;application/json&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Method) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $params.method </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Method</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Body) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $params.body </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $body</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Write-Verbose</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;ThisBody:</span><span style="color:#79B8FF;">`r`n</span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$params.Body</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $AuthHeader </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $IntegrationContext.AuthHeader </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;"> $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1AuthHeader</span></span>
<span class="line"><span style="color:#E1E4E8;">    $BaseUri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $IntegrationContext.S1Uri </span><span style="color:#F97583;">??</span><span style="color:#E1E4E8;"> $</span><span style="color:#F97583;">script</span><span style="color:#E1E4E8;">:S1Uri</span></span>
<span class="line"><span style="color:#E1E4E8;">    $Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$BaseUri</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">web/api/v2.1/</span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$Endpoint</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">do</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($QueryParameters) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">Write-Verbose</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;QueryParameters: </span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$QueryParameters</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">|</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                $UriWithQuery </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-UriQueryParameter</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Uri $Uri </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Parameter $QueryParameters</span></span>
<span class="line"><span style="color:#E1E4E8;">                $UriWithQuery </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $UriWithQuery.ToString().Replace(</span><span style="color:#9ECBFF;">&quot;+&quot;</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;%20&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Verbose</span><span style="color:#E1E4E8;"> $UriWithQuery</span></span>
<span class="line"><span style="color:#E1E4E8;">            $Results </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$null</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Invoke-RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Uri $UriWithQuery </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Headers $AuthHeader @params </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ErrorAction Stop </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Tee-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Variable Results </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Expand </span><span style="color:#F97583;">data</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">            $Results </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Format-List</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Write-Verbose</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Results.pagination </span><span style="color:#F97583;">-and</span><span style="color:#E1E4E8;"> $Results.pagination.nextcursor) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                $QueryParameters.cursor </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Results.pagination.nextcursor</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> ($Results.pagination </span><span style="color:#F97583;">-and</span><span style="color:#E1E4E8;"> $Results.pagination.nextcursor)</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Exception.Response.StatusCode </span><span style="color:#F97583;">-eq</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Unauthorized&quot;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Error</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Unauthorized when accessing </span><span style="color:#E1E4E8;">$Endpoint</span><span style="color:#9ECBFF;">, please ensure the user associated with the API Key can access this endpoint.&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Error</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Exception </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Exception </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ErrorAction Stop</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#.Exception.Response</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Get-S1Site</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Name</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Id</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    $Endpoint </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;sites&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Id) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Endpoint </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/</span><span style="color:#E1E4E8;">$id</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $QueryParameters </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{}</span></span>
<span class="line"><span style="color:#E1E4E8;">    $LimitParameter </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{ limit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Name) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $QueryParameters[</span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $CombinedParameters </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $QueryParameters </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> $LimitParameter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">-not</span><span style="color:#E1E4E8;"> $Name) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">QueryParameters $LimitParameter </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Expand sites </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Sort-Object</span><span style="color:#E1E4E8;"> name</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Sites </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">QueryParameters $CombinedParameters </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Expand sites</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">-not</span><span style="color:#E1E4E8;"> $Sites) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Progress</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;No sites matched name: </span><span style="color:#E1E4E8;">$Name</span><span style="color:#9ECBFF;"> using API filter. Fetching all sites...&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            $Sites </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">QueryParameters $LimitParameter </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Expand sites </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Sort-Object</span><span style="color:#E1E4E8;"> name</span></span>
<span class="line"><span style="color:#E1E4E8;">            $SiteCount </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Sites </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Measure-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">expand Count</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Progress</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Found </span><span style="color:#E1E4E8;">$SiteCount</span><span style="color:#9ECBFF;"> site(s)&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Sites </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> name</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> isDefault</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> registrationToken </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Write-Verbose</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Site </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Sites </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Where-Object</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.name.Trim() </span><span style="color:#F97583;">-like</span><span style="color:#E1E4E8;"> $Name } </span><span style="color:#6A737D;"># Potential edge case where the `name` property includes whitespace</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Site </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Site </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Should</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HaveOne </span><span style="color:#9ECBFF;">&quot;SentinelOne Site matching </span><span style="color:#E1E4E8;">$Name</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">TakeFirst</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Site</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Get-S1Agent</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $Endpoint </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;agents&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#E1E4E8;">    $QueryParameters </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{}</span></span>
<span class="line"><span style="color:#E1E4E8;">    $LimitParameter </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{ limit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ($Name) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $QueryParameters[</span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Name</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    $CombinedParameters </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $QueryParameters </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> $LimitParameter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">-not</span><span style="color:#E1E4E8;"> $Name) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">QueryParameters $LimitParameter </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Sort-Object</span><span style="color:#E1E4E8;"> computerName             </span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        $QueryParameters.name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Name</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Agents </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-S1RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Endpoint $Endpoint </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">QueryParameters $CombinedParameters</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">-not</span><span style="color:#E1E4E8;"> $Agents) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Progress</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;No Agents matched name: </span><span style="color:#E1E4E8;">$Name</span><span style="color:#9ECBFF;"> using API filter. Fetching all Agents...&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            $Agents </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-S1Site</span></span>
<span class="line"><span style="color:#E1E4E8;">            $AgentCount </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Agents </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Measure-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">expand Count</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">Write-Progress</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Found </span><span style="color:#E1E4E8;">$AgentCount</span><span style="color:#9ECBFF;"> agent(s)&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Agents </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Select-Object</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> name</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> isDefault</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> registrationToken </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Out-String</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Write-Verbose</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Agent </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Agent </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Where-Object</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.name.Trim() </span><span style="color:#F97583;">-like</span><span style="color:#E1E4E8;"> $Name } </span><span style="color:#6A737D;"># Potential edge case where the `name` property includes whitespace</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Agent </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $Agent </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Should</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HaveOne </span><span style="color:#9ECBFF;">&quot;SentinelOne Agent matching </span><span style="color:#E1E4E8;">$Name</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">TakeFirst</span></span>
<span class="line"><span style="color:#E1E4E8;">        $Agent</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">Export-ModuleMember</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Function </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Connect-S1API&#39;</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Invoke-S1RestMethod&#39;</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Get-S1Site&#39;</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Get-S1Agent&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Connect-S1API</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$S1Uri</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$S1APIToken</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $S1AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{ </span><span style="color:#032F62;">&#39;Authorization&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;APIToken </span><span style="color:#24292E;">$S1ApiToken</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># if we have an integration context, then store it</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">$null</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-ne</span><span style="color:#24292E;"> $IntegrationContext) {</span></span>
<span class="line"><span style="color:#24292E;">        $IntegrationContext.AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1AuthHeader</span></span>
<span class="line"><span style="color:#24292E;">    $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1Uri</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">Uri</span><span style="color:#24292E;">]$</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $S1Uri</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        $SystemInfo </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint </span><span style="color:#032F62;">&#39;system/info&#39;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($SystemInfo.latestAgentVersion </span><span style="color:#D73A49;">-like</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;*.*&quot;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Progress</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Authenticated to SentinelOne API and retrieved system/info. LatestAgentVersion: </span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$SystemInfo.LatestAgentVersion</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">            $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1AuthHeader</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$null</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Invalid response from system/info API&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Write-Verbose</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;SystemInfo:</span><span style="color:#005CC5;">`r`n</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$SystemInfo</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">Format-List</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">*</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$null</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">throw</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Invoke-S1RestMethod</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Endpoint</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Method</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Body</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">HashTable</span><span style="color:#24292E;">]$QueryParameters </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{}</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $Endpoint </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Endpoint.TrimStart(</span><span style="color:#032F62;">&#39;/&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    $params </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{}</span></span>
<span class="line"><span style="color:#24292E;">    $params.ContentType </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;application/json&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Method) {</span></span>
<span class="line"><span style="color:#24292E;">        $params.method </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Method</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Body) {</span></span>
<span class="line"><span style="color:#24292E;">        $params.body </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $body</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Write-Verbose</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ThisBody:</span><span style="color:#005CC5;">`r`n</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$params.Body</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $AuthHeader </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $IntegrationContext.AuthHeader </span><span style="color:#D73A49;">??</span><span style="color:#24292E;"> $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1AuthHeader</span></span>
<span class="line"><span style="color:#24292E;">    $BaseUri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $IntegrationContext.S1Uri </span><span style="color:#D73A49;">??</span><span style="color:#24292E;"> $</span><span style="color:#D73A49;">script</span><span style="color:#24292E;">:S1Uri</span></span>
<span class="line"><span style="color:#24292E;">    $Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$BaseUri</span><span style="color:#032F62;">)</span><span style="color:#032F62;">web/api/v2.1/</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$Endpoint</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">do</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($QueryParameters) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">Write-Verbose</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;QueryParameters: </span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$QueryParameters</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">|</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">                $UriWithQuery </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-UriQueryParameter</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Uri $Uri </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Parameter $QueryParameters</span></span>
<span class="line"><span style="color:#24292E;">                $UriWithQuery </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $UriWithQuery.ToString().Replace(</span><span style="color:#032F62;">&quot;+&quot;</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;%20&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Verbose</span><span style="color:#24292E;"> $UriWithQuery</span></span>
<span class="line"><span style="color:#24292E;">            $Results </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$null</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Invoke-RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Uri $UriWithQuery </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Headers $AuthHeader @params </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ErrorAction Stop </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Tee-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Variable Results </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Expand </span><span style="color:#D73A49;">data</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">            $Results </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Format-List</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Write-Verbose</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Results.pagination </span><span style="color:#D73A49;">-and</span><span style="color:#24292E;"> $Results.pagination.nextcursor) {</span></span>
<span class="line"><span style="color:#24292E;">                $QueryParameters.cursor </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Results.pagination.nextcursor</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> ($Results.pagination </span><span style="color:#D73A49;">-and</span><span style="color:#24292E;"> $Results.pagination.nextcursor)</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Exception.Response.StatusCode </span><span style="color:#D73A49;">-eq</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Unauthorized&quot;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Error</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Unauthorized when accessing </span><span style="color:#24292E;">$Endpoint</span><span style="color:#032F62;">, please ensure the user associated with the API Key can access this endpoint.&quot;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Error</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Exception </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Exception </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ErrorAction Stop</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#.Exception.Response</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Get-S1Site</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Name</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Id</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    $Endpoint </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;sites&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Id) {</span></span>
<span class="line"><span style="color:#24292E;">        $Endpoint </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/</span><span style="color:#24292E;">$id</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $QueryParameters </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{}</span></span>
<span class="line"><span style="color:#24292E;">    $LimitParameter </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{ limit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Name) {</span></span>
<span class="line"><span style="color:#24292E;">        $QueryParameters[</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Name</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $CombinedParameters </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $QueryParameters </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> $LimitParameter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">-not</span><span style="color:#24292E;"> $Name) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">QueryParameters $LimitParameter </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Expand sites </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Sort-Object</span><span style="color:#24292E;"> name</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        $Sites </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">QueryParameters $CombinedParameters </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Expand sites</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">-not</span><span style="color:#24292E;"> $Sites) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Progress</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;No sites matched name: </span><span style="color:#24292E;">$Name</span><span style="color:#032F62;"> using API filter. Fetching all sites...&quot;</span></span>
<span class="line"><span style="color:#24292E;">            $Sites </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">QueryParameters $LimitParameter </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Expand sites </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Sort-Object</span><span style="color:#24292E;"> name</span></span>
<span class="line"><span style="color:#24292E;">            $SiteCount </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Sites </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Measure-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">expand Count</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Progress</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Found </span><span style="color:#24292E;">$SiteCount</span><span style="color:#032F62;"> site(s)&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        $Sites </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> name</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> isDefault</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> registrationToken </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Write-Verbose</span></span>
<span class="line"><span style="color:#24292E;">        $Site </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Sites </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Where-Object</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.name.Trim() </span><span style="color:#D73A49;">-like</span><span style="color:#24292E;"> $Name } </span><span style="color:#6A737D;"># Potential edge case where the `name` property includes whitespace</span></span>
<span class="line"><span style="color:#24292E;">        $Site </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Site </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Should</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HaveOne </span><span style="color:#032F62;">&quot;SentinelOne Site matching </span><span style="color:#24292E;">$Name</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">TakeFirst</span></span>
<span class="line"><span style="color:#24292E;">        $Site</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Get-S1Agent</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Name</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $Endpoint </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;agents&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    $QueryParameters </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{}</span></span>
<span class="line"><span style="color:#24292E;">    $LimitParameter </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{ limit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ($Name) {</span></span>
<span class="line"><span style="color:#24292E;">        $QueryParameters[</span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Name</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    $CombinedParameters </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $QueryParameters </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> $LimitParameter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">-not</span><span style="color:#24292E;"> $Name) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">QueryParameters $LimitParameter </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Sort-Object</span><span style="color:#24292E;"> computerName             </span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        $QueryParameters.name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Name</span></span>
<span class="line"><span style="color:#24292E;">        $Agents </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-S1RestMethod</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Endpoint $Endpoint </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">QueryParameters $CombinedParameters</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">-not</span><span style="color:#24292E;"> $Agents) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Progress</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;No Agents matched name: </span><span style="color:#24292E;">$Name</span><span style="color:#032F62;"> using API filter. Fetching all Agents...&quot;</span></span>
<span class="line"><span style="color:#24292E;">            $Agents </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-S1Site</span></span>
<span class="line"><span style="color:#24292E;">            $AgentCount </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Agents </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Measure-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">expand Count</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">Write-Progress</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Found </span><span style="color:#24292E;">$AgentCount</span><span style="color:#032F62;"> agent(s)&quot;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        $Agents </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Select-Object</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> name</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> isDefault</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> registrationToken </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Out-String</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Write-Verbose</span></span>
<span class="line"><span style="color:#24292E;">        $Agent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Agent </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Where-Object</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.name.Trim() </span><span style="color:#D73A49;">-like</span><span style="color:#24292E;"> $Name } </span><span style="color:#6A737D;"># Potential edge case where the `name` property includes whitespace</span></span>
<span class="line"><span style="color:#24292E;">        $Agent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $Agent </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Should</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HaveOne </span><span style="color:#032F62;">&quot;SentinelOne Agent matching </span><span style="color:#24292E;">$Name</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">TakeFirst</span></span>
<span class="line"><span style="color:#24292E;">        $Agent</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">Export-ModuleMember</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Function </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Connect-S1API&#39;</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Invoke-S1RestMethod&#39;</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Get-S1Site&#39;</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Get-S1Agent&#39;</span></span>
<span class="line"><span style="color:#24292E;">)</span></span></code></pre></div><h5 id="example-respond-to-webhook-with-isupportshttprequest" tabindex="-1">Example - Respond to webhook with ISupportsHttpRequest <a class="header-anchor" href="#example-respond-to-webhook-with-isupportshttprequest" aria-label="Permalink to &quot;Example - Respond to webhook with ISupportsHttpRequest&quot;">​</a></h5><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">New-DynamicIntegration</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Init {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">OpResult</span><span style="color:#E1E4E8;">]::Ok()</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HealthCheck {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">New-HealthyResult</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">} </span></span>
<span class="line"><span style="color:#E1E4E8;">$Integration </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-DynamicIntegrationCapability</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Interface ISupportsHttpRequest </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">HandleHttpRequest {</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">CmdletBinding</span><span style="color:#E1E4E8;">()]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#79B8FF;">OutputType</span><span style="color:#E1E4E8;">([</span><span style="color:#F97583;">Microsoft.AspNetCore.Mvc.IActionResult</span><span style="color:#E1E4E8;">])]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$True</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#F97583;">Microsoft.AspNetCore.Http.HttpContext</span><span style="color:#E1E4E8;">]$httpContext</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$false</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $body</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        [</span><span style="color:#79B8FF;">Parameter</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">Mandatory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">$True</span><span style="color:#E1E4E8;">)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        $route</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># handle a http request sent to this integration</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># return an [ObjectResult] and set the status code</span></span>
<span class="line"><span style="color:#E1E4E8;">    $res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">ObjectResult</span><span style="color:#E1E4E8;">]::new(</span><span style="color:#9ECBFF;">&#39;ok&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    $res.StatusCode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> $res;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$Integration</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">New-DynamicIntegration</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Init {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">OpResult</span><span style="color:#24292E;">]::Ok()</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HealthCheck {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">New-HealthyResult</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">} </span></span>
<span class="line"><span style="color:#24292E;">$Integration </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-DynamicIntegrationCapability</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Interface ISupportsHttpRequest </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">HandleHttpRequest {</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">CmdletBinding</span><span style="color:#24292E;">()]</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#005CC5;">OutputType</span><span style="color:#24292E;">([</span><span style="color:#D73A49;">Microsoft.AspNetCore.Mvc.IActionResult</span><span style="color:#24292E;">])]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$True</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#D73A49;">Microsoft.AspNetCore.Http.HttpContext</span><span style="color:#24292E;">]$httpContext</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$false</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $body</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">        [</span><span style="color:#005CC5;">Parameter</span><span style="color:#24292E;">(</span><span style="color:#E36209;">Mandatory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">$True</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">        $route</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># handle a http request sent to this integration</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># return an [ObjectResult] and set the status code</span></span>
<span class="line"><span style="color:#24292E;">    $res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">ObjectResult</span><span style="color:#24292E;">]::new(</span><span style="color:#032F62;">&#39;ok&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    $res.StatusCode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">200</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> $res;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$Integration</span></span></code></pre></div><img width="688" alt="image" src="https://github.com/immense/immybot-documentation/assets/1424395/6bf7dd8b-3700-4414-aa57-ad6d8151245f"></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-a2d931e4><!--[--><!--]--><!----><nav class="prev-next" data-v-a2d931e4><div class="pager" data-v-a2d931e4><a class="pager-link prev" href="./windows-sandbox.html" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Previous page</span><span class="title" data-v-a2d931e4>Windows Sandbox</span></a></div><div class="pager" data-v-a2d931e4><a class="pager-link next" href="/connectwise-automate-integration-setup.html" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Next page</span><span class="title" data-v-a2d931e4>ConnectWise Automate</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"readme.md\":\"438fc68f\",\"index.md\":\"f2f4a8f7\",\"add-users.md\":\"f8ba72ba\",\"markdown-examples.md\":\"00357284\",\"ncentral-integration-setup.md\":\"3ada0ca9\",\"windows-sandbox.md\":\"420f9908\",\"releases-2022.md\":\"af99a7de\",\"faq.md\":\"0dd929cc\",\"getting-started.md\":\"77eeb39a\",\"build-your-own-integration.md\":\"b4fea51b\",\"azure-graph-permissions-setup.md\":\"3fed08cf\",\"connectwise-manage-integration-setup.md\":\"1a6ece37\",\"releases-2020.md\":\"5e3302d9\",\"recommended-deployments.md\":\"bf148213\",\"onboarding.md\":\"aa130f5b\",\"releases-2021.md\":\"50e85e31\",\"connectwise-automate-integration-setup.md\":\"8e02436d\",\"user-roles.md\":\"83b890f7\",\"troubleshooting.md\":\"3e2ed566\",\"releases.md\":\"e3d76eb1\",\"connectwise-control-integration-setup.md\":\"71f4a6e4\",\"scripts.md\":\"7cb2a745\",\"halo-integration-setup.md\":\"88bc1610\",\"immy-commands.md\":\"3f95c339\",\"terminology.md\":\"3d3e6554\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"immy.bot\",\"description\":\"A documentation suite for all things ImmyBot\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"/immybot-glasses.png\",\"sidebar\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Getting Started\",\"link\":\"/getting-started\"},{\"text\":\"What's New\",\"link\":\"/releases\"},{\"text\":\"Add Users\",\"link\":\"./add-users\"},{\"text\":\"Onboarding\",\"link\":\"./onboarding\"},{\"text\":\"Recommended Deployments\",\"link\":\"./recommended-deployments\"},{\"text\":\"Terminology\",\"link\":\"./terminology\"},{\"text\":\"Troubleshooting\",\"link\":\"./troubleshooting\"},{\"text\":\"User Roles\",\"link\":\"./user-roles\"},{\"text\":\"Windows Sandbox\",\"link\":\"./windows-sandbox\"}]},{\"text\":\"Integrations\",\"collapsed\":false,\"items\":[{\"text\":\"Build Your Own\",\"link\":\"/build-your-own-integration\"},{\"text\":\"ConnectWise Automate\",\"link\":\"/connectwise-automate-integration-setup\"},{\"text\":\"ConnectWise Control\",\"link\":\"/connectwise-control-integration-setup\"},{\"text\":\"ConnectWise Manage\",\"link\":\"/connectwise-manage-integration-setup\"},{\"text\":\"N-Central\",\"link\":\"/ncentral-integration-setup\"},{\"text\":\"HaloPSA\",\"link\":\"/halo-integration-setup\"},{\"text\":\"Azure\",\"link\":\"/azure-graph-permissions-setup\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Scripting Guide\",\"link\":\"/scripts\"},{\"text\":\"Metascripts / Cloud Scripts\",\"link\":\"/immy-commands\"}]},{\"text\":\"Frequently Asked Questions\",\"link\":\"/FAQ\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/immense/immybot-documentation\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"apiKey\":\"e84eee7e1fa61571b3814adfcb2a70f2\",\"indexName\":\"immy\",\"appId\":\"SU6GB55GXI\"}}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>