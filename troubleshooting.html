<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Troubleshooting | immy.bot</title>
    <meta name="description" content="A documentation suite for all things ImmyBot">
    <meta name="generator" content="VitePress v1.4.0">
    <link rel="preload stylesheet" href="/assets/style.CyaMcyxm.css" as="style">
    
    <script type="module" src="/assets/app.DRN3unl1.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.B49Yz1nR.js">
    <link rel="modulepreload" href="/assets/chunks/theme.BlGa_csg.js">
    <link rel="modulepreload" href="/assets/chunks/katex.CvgdMzdh.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-dc8f04df.CKb4DDrj.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-622f9fc1.UNHUO6YN.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-a33b4996.npThVBEn.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-51d2b61e.BKvP5nV4.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-23af1bdb.xtAOwR_N.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-a649f789.B3MVSZyS.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-f86e0131.CYcEreMK.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-31d824a1.BcWock7l.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-a712a7d9.CBHMGHp7.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-4a8b8217.BboCrNzl.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-eb878fee.DLnn6pB1.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-66748113.CycNJCqh.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-8298e144.B6ahrBSz.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-296fb1cd.BlvxQji3.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-35d39939.CGFuH3-m.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-6c43c13a.on8Hb2_5.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-de0d04b7.Cjc0E3Qw.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-930acc39.RaYPOHcR.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-6eaa3543.oX4ehz4e.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-b08d3ac4.BURIHg2K.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-c599f8ec.DnE5IYY2.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-a8a0820c.B3oN9ihx.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/troubleshooting.md._hAa0pQ-.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script>(function(t,n,r,e,m){t[e]=t[e]||[],t[e].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s=e!="dataLayer"?"&l="+e:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-PF34XF88");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar has-sidebar top" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-0ad69264><a class="title" href="/" data-v-0ad69264><!--[--><!--]--><!--[--><img class="VPImage logo" src="/immybot-glasses.png" alt data-v-ab19afbb><!--]--><span data-v-0ad69264>immy.bot</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-edd2eed8><span class="vpi-chevron-right caret-icon" data-v-edd2eed8></span></div></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/getting-started.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Getting Started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/releases.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>What's New</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./add-users.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Add Users</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./onboarding.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Onboarding</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./recommended-deployments.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Recommended Deployments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./terminology.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Terminology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./troubleshooting.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Troubleshooting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./user-roles.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>User Roles</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="./windows-sandbox.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Windows Sandbox</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>Integrations</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-edd2eed8><span class="vpi-chevron-right caret-icon" data-v-edd2eed8></span></div></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/build-your-own-integration.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Build Your Own</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/connectwise-automate-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>ConnectWise Automate</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/connectwise-control-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>ConnectWise Control</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/connectwise-manage-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>ConnectWise Manage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/ncentral-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>N-Central</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/ninjarmm-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>NinjaRMM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/halo-integration-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>HaloPSA</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/azure-graph-permissions-setup.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Azure</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>Advanced</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-edd2eed8><span class="vpi-chevron-right caret-icon" data-v-edd2eed8></span></div></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/scripts.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Scripting Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/immy-commands.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Metascripts / Cloud Scripts</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><!----><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/FAQ.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Frequently Asked Questions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _troubleshooting" data-v-e6f2a212><div><div class="danger custom-block"><p class="custom-block-title"><em>ImmyBot will no longer support Windows 7, Server 2008 (or Server 2012 w/o <a href="https://learn.microsoft.com/en-us/windows-server/get-started/extended-security-updates-overview" target="_blank" rel="noreferrer">ESUs</a>) machines after May 14th, 2024</em></p><p>.NET 7 support is ending May 14th, and as a result we will be transitioning the Agent to .NET 8 at that time period. We will not be offering support for these machines after May 14th.</p><p>Please see the <a href="https://docs.immy.bot/FAQ.html#what-windows-versions-does-immyagent-support" target="_blank" rel="noreferrer">FAQ section for more details</a></p></div><h1 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h1><h2 id="identification-failures" tabindex="-1">Identification Failures <a class="header-anchor" href="#identification-failures" aria-label="Permalink to &quot;Identification Failures&quot;">​</a></h2><h3 id="needs-a-manual-decision" tabindex="-1">Needs a Manual Decision <a class="header-anchor" href="#needs-a-manual-decision" aria-label="Permalink to &quot;Needs a Manual Decision&quot;">​</a></h3><p>Generally you will click &quot;Agent Re-installed&quot;</p><p>Often when an RMM Agent gets re-installed, it will get a new id in the RMM (ComputerId in Automate, SessionID in Control). ImmyBot will recognize that it is the same computer, but due to the fact that virtualization technologies and hard drive cloning can lead to the same scenario, we require you to tell us whether we should overwrite the existing RmmComputer, or keep both. 99% of the time you will click &quot;Overwrite Existing&quot;. If the machine was in fact cloned, you would click Keep Both, in which case Immy shims the duplicate UUID with its own to prevent collisions.</p><h2 id="pending-computers" tabindex="-1">Pending Computers <a class="header-anchor" href="#pending-computers" aria-label="Permalink to &quot;Pending Computers&quot;">​</a></h2><p>Computers in the pending status have yet to be identified.</p><p>Computers may get stuck here if we are unable to run our Ephemeral Agent</p><div class="mermaid">null</div><p>Top 3 reasons for Identification Failures</p><ol><li>SSL Inspection blocking our websocket</li><li>Security Software blocking PowerShell</li><li>Incorrect time is preventing SSL/TLS connection</li></ol><p>To understand the various reasons identification can fail, it helps to understand how ImmyBot executions PowerShell</p><ol><li>RMM or ImmyAgent runs Immybot.Agent.Ephemeral.exe</li><li>Immybot.Agent.Ephemeral.exe establishes a secure websocket to wss://subdomain.immy.bot and runs Invoke-PSPipeHost.ps1</li><li>Immybot.Agent.Ephemeral.exe feeds Invoke-PSPipeHost.ps1 PowerShell over a pipe from the websocket session</li></ol><div class="mermaid">null</div><p>The most common cause of identification failure is security software.</p><p>To know if this is the case, pull the logs from C:\ProgramData\ImmyBotAgentService*.log</p><p><img src="https://user-images.githubusercontent.com/1424395/173621779-51bd5d6d-e877-41a3-9b68-c1724747db21.png" alt="image"></p><p>Normal Immybot Agent logs look like this:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2022-06-14 00:02:25.560 -05:00 [DBG] Hosting starting</span></span>
<span class="line"><span>2022-06-14 00:02:25.799 -05:00 [INF] Starting Immybot Agent</span></span>
<span class="line"><span>2022-06-14 00:02:25.943 -05:00 [INF] Using configuration file stored at: C:\ProgramData\ImmyBotAgentService\config.json</span></span>
<span class="line"><span>2022-06-14 00:02:26.875 -05:00 [DBG] Initializing IoT Hub connection</span></span>
<span class="line"><span>2022-06-14 00:02:35.023 -05:00 [INF] Application started. Hosting environment: Production; Content root path: C:\WINDOWS\TEMP\.net\Immybot.Agent.Service\lreaszzz.wwx\</span></span>
<span class="line"><span>2022-06-14 00:02:35.024 -05:00 [DBG] Hosting started</span></span>
<span class="line"><span>2022-06-14 00:02:40.552 -05:00 [WRN] IoT Hub connection status Changed Status =&gt; [Connected] Reason =&gt; [Connection_Ok]</span></span>
<span class="line"><span>2022-06-14 02:06:32.159 -05:00 [DBG] Process started; ID: 12724</span></span>
<span class="line"><span>2022-06-14 02:06:37.358 -05:00 [DBG] Running C:\ProgramData\ImmyBot\Scripts\840290f2bd2142e2bd2c612542436763\Immybot.Agent.Ephemeral.exe --ImmyScriptPath C:\ProgramData\ImmyBot\Scripts\840290f2bd2142e2bd2c612542436763 --BackendAddress wss://immense.immy.bot/ --SessionID c946e1d1-f5fd-d36d-0489-d2a9ad9084e0</span></span>
<span class="line"><span>2022-06-14 02:06:38.335 -05:00 [DBG] PID 16184 &lt;----- Indicates successful execution</span></span>
<span class="line"><span>2022-06-14 02:06:38.372 -05:00 [DBG] Process exited; Code: 0</span></span></code></pre></div><p>Windows Defender will make the logs look like this:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2022-11-17 13:13:36.604 +11:00 [DBG] Hosting starting</span></span>
<span class="line"><span>2022-11-17 13:13:36.817 +11:00 [INF] Starting Immybot Agent</span></span>
<span class="line"><span>2022-11-17 13:13:36.840 +11:00 [INF] Using configuration file stored at: C:\ProgramData\ImmyBotAgentService\config.json</span></span>
<span class="line"><span>2022-11-17 13:13:37.590 +11:00 [DBG] Initializing IoT Hub connection</span></span>
<span class="line"><span>2022-11-17 13:13:37.860 +11:00 [DBG] Hosting started</span></span>
<span class="line"><span>2022-11-17 13:13:38.598 +11:00 [WRN] IoT Hub connection status Changed Status =&gt; [Connected] Reason =&gt; [Connection_Ok]</span></span>
<span class="line"><span>2022-11-17 13:13:39.157 +11:00 [WRN] Dirty-Shutdown detected! Dirty-File created at: &quot;2022-11-07T04:11:59.3975026Z&quot; UTC</span></span>
<span class="line"><span>2022-11-17 13:13:41.686 +11:00 [DBG] Process started; ID: 5660</span></span>
<span class="line"><span>2022-11-17 13:13:44.674 +11:00 [DBG] Running C:\ProgramData\ImmyBot\Scripts\4303da9b790b41c6978b50b872fe17cb\Immybot.Agent.Ephemeral.exe --ImmyScriptPath C:\ProgramData\ImmyBot\Scripts\4303da9b790b41c6978b50b872fe17cb --BackendAddress wss://ericom.immy.bot/ --SessionID a92c0ed1-ea3b-7f8a-d9c6-946d9b44ccc5</span></span>
<span class="line"><span>2022-11-17 13:13:49.577 +11:00 [DBG] WMI Error 2</span></span></code></pre></div><p>DNS Filtering/Issues make the logs look like this</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2022-09-20 20:39:59.712 +10:00 [INF] RESPONSE: {</span></span>
<span class="line"><span>  &quot;Resource&quot;: &quot;installer/challenge/request&quot;,</span></span>
<span class="line"><span>  &quot;Method&quot;: &quot;POST&quot;,</span></span>
<span class="line"><span>  &quot;StatusCode&quot;: 0,</span></span>
<span class="line"><span>  &quot;ErrorException&quot;: {</span></span>
<span class="line"><span>    &quot;ClassName&quot;: &quot;System.Net.WebException&quot;,</span></span>
<span class="line"><span>    &quot;Message&quot;: &quot;No such host is known. (XXXX.immy.bot:443)&quot;</span></span></code></pre></div><p>To correct it, you need to exclude DNS filtering for your instances hostnames, which are found under Show more &gt; integrations &gt; Fetch IP Address and Hostnames</p><p>If Powershell is failing to start on the endpoint within 60 seconds a timeout will occur.</p><p>Here is a suggestion on a cause and possible fix for that one <a href="https://www.reddit.com/r/PowerShell/comments/rx68fw/powershell_slow_to_open_long_load_timesfixed" target="_blank" rel="noreferrer">https://www.reddit.com/r/PowerShell/comments/rx68fw/powershell_slow_to_open_long_load_timesfixed</a></p><h2 id="security-software-exclusions" tabindex="-1">Security Software Exclusions <a class="header-anchor" href="#security-software-exclusions" aria-label="Permalink to &quot;Security Software Exclusions&quot;">​</a></h2><p>Ideally you would instruct your security software would support excluding code signed by</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CN=Immense Networks LLC, O=Immense Networks, L=Baton Rouge, S=Louisiana, C=US</span></span></code></pre></div><p>Exclusions based on code signing certificate are an industry standard feature and should be a standard feature in any best-in-class security software. However, if your security software is unable to exclude based on code signing certificate, create an exclusion for your instance&#39;s Script Path.</p><p>Your script path can be found under Settings-&gt;Preferences-&gt;Script Path</p><p><img src="https://user-images.githubusercontent.com/1424395/173610304-50bab775-c7c8-40b3-944e-fab1dde862ee.png" alt="image"></p><ul><li><a href="#threatlocker">ThreatLocker</a></li><li><a href="#sophoscentral">Sophos Central</a></li><li><a href="#bitdefender">BitDefender</a></li><li><a href="#crowdstrike">CrowdStrike</a></li><li><a href="#microsoft-defender-for-endpoint">Microsoft Defender for Endpoint</a></li><li><a href="#cylance">Cylance</a></li><li><a href="#sentinelone">SentinelOne</a></li><li><a href="#dnsfilter">DNSFilter</a></li></ul><h3 id="threatlocker" tabindex="-1">ThreatLocker <a class="header-anchor" href="#threatlocker" aria-label="Permalink to &quot;ThreatLocker&quot;">​</a></h3><ol><li>Application Control-&gt; Applications</li><li>Create New Application</li><li>Put the following value into Certificate and click Add</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CN=Immense Networks LLC, O=Immense Networks, L=Baton Rouge, S=Louisiana, C=US</span></span></code></pre></div><ol start="4"><li>Add your instance’s <a href="#script-path-exclusion">script path</a><img src="https://user-images.githubusercontent.com/1424395/173602708-b8e239f8-efaa-4e16-a29c-9fb66f72e616.png" alt="image"> Ultimately it should look like this: <img src="https://user-images.githubusercontent.com/1424395/173602739-2b60922f-5ac8-4d4c-bc93-d52a390e129e.png" alt="image"></li><li>Create a New Application Policy <img src="https://user-images.githubusercontent.com/1424395/173602798-7042c0ea-1406-476c-a291-0deee6e843c5.png" alt="image"></li></ol><h3 id="sophos-central" tabindex="-1">Sophos Central <a class="header-anchor" href="#sophos-central" aria-label="Permalink to &quot;Sophos Central&quot;">​</a></h3><p><strong>Tenant Specific</strong> Manual Addition:</p><ol><li>Launch Client Shell</li><li>Navigate to Global Settings - Allowed Applications</li><li>Select &quot;Add apps&quot;</li><li>In the &quot;allow by:&quot; dropdown, select certificate and add the following</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CN=Immense Networks LLC, O=Immense Networks, L=Baton Rouge, S=Louisiana, C=US</span></span></code></pre></div><p>Event Log Method: If Sophos reports that Immy Bot has been blocked, you have the option of going to the Event Log and and select the option to allow by Certificate. This will only work if Sophos has picked up an alert for a process signed by the Immy Bot code signing certificate</p><p><strong>Partner Global Templates</strong></p><ol><li>Navigate to Settings &amp; Policies - Global Templates and select the template you would like to modify</li><li>Once in the template, navigate to Global Settings - Allowed Applications</li><li>Follow steps 3 and 4 listed in the <strong>Tenant Specific</strong> section above</li></ol><h3 id="bitdefender" tabindex="-1">BitDefender <a class="header-anchor" href="#bitdefender" aria-label="Permalink to &quot;BitDefender&quot;">​</a></h3><p>BitDefender will intermittently block script execution unless you disable Aggressive scanning mode or add a your instance&#39;s <a href="#security-software-exclusions">Script Path</a> to your policy&#39;s exclusion list.</p><ol><li>Edit the policy-&gt;Antimalware-&gt;Settings-&gt;In-policy Exclusions</li><li>Add a folder exclusion for your <a href="#security-software-exclusions">Script Path</a></li></ol><h3 id="crowdstrike" tabindex="-1">CrowdStrike <a class="header-anchor" href="#crowdstrike" aria-label="Permalink to &quot;CrowdStrike&quot;">​</a></h3><p>CrowdStrike uses AI to decide what to allow and disallow. Periodically this AI will mark the ImmyBot Agent or ImmyBot Ephemeral Agent as malicious. This usually happens after we update it. Marking it as a false positive in your CrowdStrike portal will train the global AI to not treat it as malicious.</p><h3 id="microsoft-defender-for-endpoint" tabindex="-1">Microsoft Defender for Endpoint <a class="header-anchor" href="#microsoft-defender-for-endpoint" aria-label="Permalink to &quot;Microsoft Defender for Endpoint&quot;">​</a></h3><p>Add a your instance&#39;s <a href="#security-software-exclusions">Script Path</a> to your policy&#39;s exclusion list. <a href="https://docs.microsoft.com/en-us/mem/intune/configuration/device-restrictions-configure#create-the-profile" target="_blank" rel="noreferrer">https://docs.microsoft.com/en-us/mem/intune/configuration/device-restrictions-configure#create-the-profile</a></p><h3 id="cylance" tabindex="-1">Cylance <a class="header-anchor" href="#cylance" aria-label="Permalink to &quot;Cylance&quot;">​</a></h3><p>Cylance blocks our websocket making the ImmybotAgent log look like this:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2022-09-21 12:24:26.562 -04:00 [INF] Process exiting.</span></span>
<span class="line"><span>2022-09-21 12:24:40.106 -04:00 [DBG] Closing Websocket...</span></span>
<span class="line"><span>2022-09-21 12:24:49.743 -04:00 [INF] Marked ConnectionState as disconnected.</span></span>
<span class="line"><span>2022-09-21 12:24:50.171 -04:00 [ERR] Application shutting down (App lifetime token cancelled)</span></span>
<span class="line"><span>System.IO.IOException: Cannot access a closed stream.</span></span>
<span class="line"><span>at System.Net.Http.HttpConnection.RawConnectionStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)</span></span></code></pre></div><p>To correct it, you need to bypass SSL Inspection for your instances hostnames/IPs, which are found under Show more &gt; integrations &gt; Fetch IP Address and Hostnames</p><h3 id="sentinelone" tabindex="-1">SentinelOne <a class="header-anchor" href="#sentinelone" aria-label="Permalink to &quot;SentinelOne&quot;">​</a></h3><p>Sentinel requires BOTH your instance&#39;s Script path and the ImmyBot Agent process excluded. With only the script path excluded, devices will regularly have issues running the ImmyBot Agent to download the ephemeral agent. This is apparent in two cases:</p><ol><li>Importing devices - The new agent can&#39;t download the ephemeral agent to start running inventory.</li><li>Updating ImmyBot Agents - The new agent can&#39;t download the corresponding new ephemeral agent when attempting to run deployments or scripts.</li></ol><p>You can also set your Exclusion Mode to &quot;Interoperability - Extended&quot;.</p><h3 id="dnsfilter" tabindex="-1">DNSFilter <a class="header-anchor" href="#dnsfilter" aria-label="Permalink to &quot;DNSFilter&quot;">​</a></h3><p>There have been reports indicating that DNSFilter, along with potentially other DNS filtering tools, is not directly blocking subdomain.immy.bot but has failed to resolve some DNS queries.</p><p>Specifically, in the case of DNSFilter, it was confirmed that ImmyBot was not being blocked. However, the failure in DNS resolution meant that connection attempts to the backend were unsuccessful.</p><p>Explicitly allowing the DNS for subdomain.immy.bot (replacing &quot;subdomain&quot; with your specific ImmyBot instance subdomain) was verified to resolve the issue of failed DNS resolutions.</p><p>For guidance on managing allow and block lists, please refer to: <a href="https://help.dnsfilter.com/hc/en-us/articles/1500008111381-Allow-and-Block-Lists" target="_blank" rel="noreferrer">https://help.dnsfilter.com/hc/en-us/articles/1500008111381-Allow-and-Block-Lists</a></p><h3 id="group-policy-objects" tabindex="-1">Group Policy Objects <a class="header-anchor" href="#group-policy-objects" aria-label="Permalink to &quot;Group Policy Objects&quot;">​</a></h3><p>Computer Configuration | Policies | Administrative Templates | Windows Components | Windows PowerShell | Turn on Script Execution (Enabled)</p><p>User Configuration | Policies | Administrative Templates | Windows Components | Windows PowerShell | Turn on Script Execution (Enabled)</p><p>These GPOs have been known to cause issues with running scripts.</p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><!----></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/getting-started.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Getting Started</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"add-users.md\":\"OaI5tNlY\",\"azure-graph-permissions-setup.md\":\"CQS9UkSF\",\"build-your-own-integration.md\":\"CbdX9QBf\",\"connectwise-automate-integration-setup.md\":\"BbRfz9pz\",\"connectwise-control-integration-setup.md\":\"BR0Z4rIs\",\"connectwise-manage-integration-setup.md\":\"qxVZT16I\",\"faq.md\":\"B36G0pkM\",\"getting-started.md\":\"R7bijnbI\",\"halo-integration-setup.md\":\"Bn8P35Lb\",\"immy-commands.md\":\"v4hM1wNE\",\"index.md\":\"DZBl2ip8\",\"markdown-examples.md\":\"-m8imKgy\",\"ncentral-integration-setup.md\":\"CSRJTbb9\",\"ninjarmm-integration-setup.md\":\"DQh0drIy\",\"old-ncentral-integration-setup.md\":\"9C3B6NVP\",\"onboarding.md\":\"DvY8VkVM\",\"readme.md\":\"D38tZSjJ\",\"recommended-deployments.md\":\"CsGVHl4O\",\"releases-2020.md\":\"DPH-1fDz\",\"releases-2021.md\":\"BS1iS6In\",\"releases-2022.md\":\"HDb-adly\",\"releases.md\":\"D4RyUjFl\",\"scripts.md\":\"C-uxU55o\",\"terminology.md\":\"Wz1ZetDt\",\"troubleshooting.md\":\"_hAa0pQ-\",\"user-roles.md\":\"CJ8-YXJu\",\"windows-sandbox.md\":\"c7d4kCuI\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"immy.bot\",\"description\":\"A documentation suite for all things ImmyBot\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/immybot-glasses.png\",\"sidebar\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Getting Started\",\"link\":\"/getting-started\"},{\"text\":\"What's New\",\"link\":\"/releases\"},{\"text\":\"Add Users\",\"link\":\"./add-users\"},{\"text\":\"Onboarding\",\"link\":\"./onboarding\"},{\"text\":\"Recommended Deployments\",\"link\":\"./recommended-deployments\"},{\"text\":\"Terminology\",\"link\":\"./terminology\"},{\"text\":\"Troubleshooting\",\"link\":\"./troubleshooting\"},{\"text\":\"User Roles\",\"link\":\"./user-roles\"},{\"text\":\"Windows Sandbox\",\"link\":\"./windows-sandbox\"}]},{\"text\":\"Integrations\",\"collapsed\":false,\"items\":[{\"text\":\"Build Your Own\",\"link\":\"/build-your-own-integration\"},{\"text\":\"ConnectWise Automate\",\"link\":\"/connectwise-automate-integration-setup\"},{\"text\":\"ConnectWise Control\",\"link\":\"/connectwise-control-integration-setup\"},{\"text\":\"ConnectWise Manage\",\"link\":\"/connectwise-manage-integration-setup\"},{\"text\":\"N-Central\",\"link\":\"/ncentral-integration-setup\"},{\"text\":\"NinjaRMM\",\"link\":\"/ninjarmm-integration-setup\"},{\"text\":\"HaloPSA\",\"link\":\"/halo-integration-setup\"},{\"text\":\"Azure\",\"link\":\"/azure-graph-permissions-setup\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Scripting Guide\",\"link\":\"/scripts\"},{\"text\":\"Metascripts / Cloud Scripts\",\"link\":\"/immy-commands\"}]},{\"text\":\"Frequently Asked Questions\",\"link\":\"/FAQ\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/immense/immybot-documentation\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"apiKey\":\"e84eee7e1fa61571b3814adfcb2a70f2\",\"indexName\":\"immy\",\"appId\":\"SU6GB55GXI\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>