import{_ as s,a as e,b as t}from"./chunks/2021-03-23-19-08-30.VBYdH6Lk.js";import{_ as i,c as a,o as n,a6 as o}from"./chunks/framework.DjuTDr2V.js";const l="/assets/2021-03-23-19-12-34.CG7rfZXP.png",r="/assets/2021-03-23-19-13-56.CFFMqynk.png",h="/assets/2021-03-23-19-17-38.BmCAN_6B.png",p="/assets/2021-03-23-19-21-03.BYLLD4md.png",c="/assets/2021-03-23-19-24-06.Ce3piVsb.png",F=JSON.parse('{"title":"ConnectWise Control","description":"","frontmatter":{},"headers":[],"relativePath":"connectwise-control-integration-setup.md","filePath":"connectwise-control-integration-setup.md"}'),d={name:"connectwise-control-integration-setup.md"},k=o('<h1 id="connectwise-control" tabindex="-1">ConnectWise Control <a class="header-anchor" href="#connectwise-control" aria-label="Permalink to &quot;ConnectWise Control&quot;">​</a></h1><p>Setting up this integration allows you to</p><ol><li>Import customers from Control</li><li>Import computers from Control</li><li>Manage all computers in Control without deploying the ImmyBot Agent</li><li>Remote into computers from the ImmyBot interface using Control (Note: We default to requiring customer consent, you can disable this under Settings-&gt;Preferences)</li><li>Fix the Automate agent using the Control agent (by creating a cross-tenant deployment for the Automate Agent and creating a schedule for your customers)</li></ol><h2 id="install-immybot-extension-for-control" tabindex="-1">Install ImmyBot Extension for Control <a class="header-anchor" href="#install-immybot-extension-for-control" aria-label="Permalink to &quot;Install ImmyBot Extension for Control&quot;">​</a></h2><p><img src="'+l+'" alt=""></p><p><img src="'+r+'" alt=""></p><p><img src="'+h+'" alt=""></p><h2 id="create-rmmlink-for-control" tabindex="-1">Create RMMLink for Control <a class="header-anchor" href="#create-rmmlink-for-control" aria-label="Permalink to &quot;Create RMMLink for Control&quot;">​</a></h2><p><img src="https://github.com/immense/immybot-documentation/assets/95599350/157501cd-b0df-48fa-9a31-d6445777a04b" alt="image"><img src="https://github.com/immense/immybot-documentation/assets/95599350/7b8b278e-ce38-48bc-a12f-509542556f43" alt="image"><img src="https://github.com/immense/immybot-documentation/assets/95599350/92bc66c7-6f07-4665-94fe-d849258bd159" alt="image"></p><h2 id="faq" tabindex="-1">FAQ <a class="header-anchor" href="#faq" aria-label="Permalink to &quot;FAQ&quot;">​</a></h2><p>What custom property do I use?</p><p>By default most ConnectWise Control instances you would select 1 for the ClientName CustomProperty field, this is the &quot;Company&quot; property in Control. Secondary group is any number between 1-8 that you would like to group from based on Control groups. You can find more infomation about Control custom propertys here; <a href="https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Administration_page/Appearance_page/Add_custom_properties_to_sessions" target="_blank" rel="noreferrer">https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Administration_page/Appearance_page/Add_custom_properties_to_sessions</a></p><h2 id="import-your-customers" tabindex="-1">Import your customers <a class="header-anchor" href="#import-your-customers" aria-label="Permalink to &quot;Import your customers&quot;">​</a></h2><p><img src="'+s+'" alt=""></p><p><img src="'+e+'" alt=""></p><p>Alternatively, you can create/map only certain customers.</p><p>When you map a customer from an RMM, the computers will undergo Identification</p><p><img src="'+p+'" alt=""></p><p><img src="'+c+'" alt=""></p><p><img src="'+t+`" alt=""></p><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><p>ConnectWise Control uses Sqlite under the hood, making it vulnerable to performance issues unless aggressive Database Maintenance Tasks are enabled.</p><p>While ImmyBot only uses Control (and other integrations) to spawn an out-of-band connection, over the course of time the database can grow as ImmyBot establishes this connection on each machine once every 24 hours to collect inventory.</p><p>Commands go into the SessionEvent table with EventType = 44 Responses go into SessionConnectionEvent with EventType = 70</p><h3 id="automatic-cleanup" tabindex="-1">Automatic Cleanup <a class="header-anchor" href="#automatic-cleanup" aria-label="Permalink to &quot;Automatic Cleanup&quot;">​</a></h3><p>Ensure you have the following maintenance actions: Access Sessions: Purge records of session activity older than 7 days for all events EXCEPT AddedNote</p><p><img src="https://user-images.githubusercontent.com/1424395/160918827-b5de85c0-b528-46cc-bb21-5815fcb07fd0.png" alt="image"></p><p>Access Sessions: Purge records of session connections older than 7 days for Host and Guest connections</p><p><img src="https://user-images.githubusercontent.com/1424395/160918906-6d6c0485-fe57-4ff8-b52f-99fa03b4cd74.png" alt="image"></p><h3 id="manual-cleanup" tabindex="-1">Manual Cleanup <a class="header-anchor" href="#manual-cleanup" aria-label="Permalink to &quot;Manual Cleanup&quot;">​</a></h3><p>If you host Control yourself, you can restore performance by doing the following</p><p>Download and Install <a href="https://sqlitebrowser.org/" target="_blank" rel="noreferrer">DB Browser for SQLite</a> on your server Open <code>C:\\Program Files (x86)\\ScreenConnect\\App_Data\\session.db</code> Navigate to SQL Editor Paste in the following SQL</p><h4 id="soft-delete-all-commands-and-responses-this-usually-solves-the-problem-without-kicking-everyone-out-of-control" tabindex="-1">Soft delete all commands and responses (This usually solves the problem without kicking everyone out of Control) <a class="header-anchor" href="#soft-delete-all-commands-and-responses-this-usually-solves-the-problem-without-kicking-everyone-out-of-control" aria-label="Permalink to &quot;Soft delete all commands and responses (This usually solves the problem without kicking everyone out of Control)&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SessionEvent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EventAttributes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EventType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 44</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SessionConnectionEvent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EventAttributes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EventType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>You will need to commit the changes in DB Browser. You can do this by clicking Write Changes at the top by clicking File-&gt;Save If you forget to tdo this it will prompt you to commit the changes, when you exit, click yes.</p><p>The reason this works is because the UI doesn&#39;t fetch soft-deleted items, so things become much snappier.</p><p>However, if it doesn&#39;t work, do you following</p><h4 id="delete-commands-and-responses-older-than-7-days" tabindex="-1">Delete commands and responses older than 7 days <a class="header-anchor" href="#delete-commands-and-responses-older-than-7-days" aria-label="Permalink to &quot;Delete commands and responses older than 7 days&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Delete queue commands in db older than 7 days</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SessionEvent</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (EventType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 44</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATETIME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;now&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;-7 day&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Delete responses older than 7 days</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SessionConnectionEvent</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (EventType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 70</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATETIME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;now&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;-7 day&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div>`,39),m=[k];function u(g,y,E,f,b,C){return n(),a("div",null,m)}const D=i(d,[["render",u]]);export{F as __pageData,D as default};
